{% extends "../base.html" %}

{% block title %}Bible Verse Sets ({{selected_subnav}}){% end %}
{% block page_content %}
{% from verserain.utils.date import pretty_date %}
{% from verserain.verse import language %}

{% if user and (selected_nav == "my sets") %}
<div class="pad_bottom">
  <a  class="pure-button" href="/verseset/create">create a verse set</a>
</div>
{% elif selected_subnav in ("popular", "hot", "new") %}
<div class="pad_bottom">
        <a class="pure-button {% if selected_subnav=="popular" %}pure-button-primary{% end %}" href="/versesets/popular/{{language_code}}">Popular</a>
        <a class="pure-button {% if selected_subnav=="new" %}pure-button-primary{% end %}" href="/versesets/new/{{language_code}}">New</a>
        <a class="pure-button" href="/verseset/create">Create</a>
<form style="display:inline;float:right;padding-top:7px;">
&nbsp; Language: &nbsp; <select name="language" onchange="location.href='/versesets/{{selected_subnav}}/'+this.value;">
<option value="all" {% if language_code.lower() == "all" %}selected {% end %}>All Languages</option>
{% for lang_code in language.LANGUAGE_CODES %}
<option value="{{lang_code}}" {% if lang_code == language_code %}selected{% end %} >{{language.LANGUAGE_BY_CODE[lang_code]}}</option>
{% end %}
</select>
</form>
</div>
{% else %}
<h3>{{selected_subnav}}'s Verse Sets</h3>
{% end %}

<table class="pure-table pure-table-bordered pad_bottom" style="width:100%;">

<thead><tr><th>Verse Set</th>
{% if language_code == "ALL" %}
<th>Language</th>
{% end %}
<th>Verses</th>
<th>Plays</th>
<th>Created</th>
<th>Author</th></thead>
<tbody>
{% for verseset in versesets %}
<tr>
  <td>{% module VerseSetLink(verseset) %} <a style="float:right;" class="pure-button button-xsmall next" href="/verseset/play/{{verseset._id}}" >&#9658</a>
  </td>

  </td>
{% if language_code == "ALL" %}
  <td>{{language.language_by_code(verseset['language'])}}</td>
{% end %}
  {% set vuser = verseset.user() %}
  <td>{{verseset.verse_count()}}</td>
  <td>{{verseset.play_count()}}</td>
  <td>{{pretty_date(verseset.created_at())}}</td>
  <td>{% module UserLink(user=vuser) %}</td>
</tr>
{% end %}
</tbody>
</table>
<br/>

{% if paginator.has_prev or paginator.has_next %}
<ul class="pure-paginator">
  {% if paginator.has_prev %}
  <li><a class="pure-button button-xsmall prev" href="{{base_url}}/{{paginator.page-1}}">&#171;</a></li>
  {% end %}
{% for page in paginator.iter_pages() %}
  {% if page %}
  <li><a class="pure-button button-xsmall {% if page == paginator.page %}pure-button-active{% end %}" href="{{base_url}}/{{page}}">{{page}}</a></li>
  {% end %}
{% end %}
  {% if paginator.has_next %}
  <li><a class="pure-button button-xsmall next" href="{{base_url}}/{{paginator.page+1}}">&#187;</a></li>
  {% end %}
</ul>
{% end %}
{% end %}
