B1;2c{% extends "../base.html" %}

{% block script_content %}
{% end %}

{% block title %}{{verseset['name']}} - Bible Verse Set{% end %}

{% block page_content %}

<div>
<div class="heading">{{verseset.get('name')}}</div>
{% set author = verseset.user() %}
<div class="pad_bottom">by {% module UserLink(user=author) %}</div>

{% set commentary_text = verseset.get_commentary_text() %}
{% if commentary_text %}
<div class="commentary_text pad_bottom paragraph">
{% raw commentary_text %}
</div>
{% end %}

<div class="pad_bottom">
<a class="link" href="/verseset/play/{{verseset._id}}">play challenge</a> &nbsp;

{% if user and ((verseset['user_id'] == user._id) or user.is_admin()) %}
<a class="link" href="/verseset/edit/{{verseset._id}}">edit</a> &nbsp;
<a class="link" onclick="return vr.confirm_delete();" href="/verseset/remove/{{verseset._id}}">remove</a>
{% end %}
</div>

</div>

<br/>
<table>

<tbody>
{% set i = 1 %}
{% for v in verses %}
<tr><td class="verseset_show">
<div ><span style="font-weight:bold;">{{i}}. {{v['reference'] }}</span>

{% if v.has_key('version') %}
({{v['version']}})
{% end %}
</div>

<div class="">{{v['text']}}</div>
<div class="links">

<a class="link" href="/verse/play/{{v._id}}">play verse</a> &nbsp;

{% if user and ((verseset['user_id'] == user._id) or user.is_admin()) %}
 <a class="link" href="/verse/edit/{{v._id}}">edit</a>  &nbsp;
 <a class="link" onclick="return vr.confirm_delete();" href="/verse/remove/{{v._id}}">remove</a>
{% end %}

</td></tr>
{% set i += 1 %}
{% end %}
</tbody>

</table>

{% from verserain.utils.date import pretty_date %}

<h3>High Scores</h3>
<table class="pure-table pure-table-bordered">
<thead><tr><th>#</th><th>User</th><th>Score</th><th>Date</th></tr></thead>

<tbody>
{% if len(scores) == 0 %}
<tr><td colspan="4">No one has submitted scores for challenge mode yet.</td></tr>
{% end %}

{% set i = 1 %}
{% for score in scores %}
<tr><td>{{i}}</td><td><a class="link" href="/{{score['username']}}/versesets">{{score['username']}}</a></td><td>{{score['score']}}</td><td>{{pretty_date(score['date'])}}</td></tr>
{% set i = i + 1 %}
{% end %}
</tbody>
</table>

<br/>

{% if user and (verseset['user_id'] == user._id) %}
{% include "../verse/_form.html" %}
{% end %}


{% end %}
